const f={Accept:"application/json","X-Requested-With":"XMLHttpRequest"};function g(){console.log("CSRF Debug - Starting token search...");const t=window.config;console.log("CSRF Debug - window.config exists:",!!t);const e=t?.csrf_token;if(e)return console.log("CSRF Debug - Token from window.config:",e.substring(0,8)+"...","length:",e.length),e;const n=document.getElementById("csrfToken");if(console.log("CSRF Debug - csrfElement exists:",!!n),n&&n.value)return console.log("CSRF Debug - Token from HTML element:",n.value.substring(0,8)+"...","length:",n.value.length),n.value;const o=document.querySelector('meta[name="csrf-token"]');return console.log("CSRF Debug - metaElement exists:",!!o),o&&o.content?(console.log("CSRF Debug - Token from meta tag:",o.content.substring(0,8)+"...","length:",o.content.length),o.content):(console.error("CSRF Debug - No token found in any location!"),console.error("CSRF Debug - Available elements:",{csrfInput:!!document.getElementById("csrfToken"),metaTag:!!document.querySelector('meta[name="csrf-token"]'),windowConfig:!!t}),"")}function m(t,e,n){return new Promise((o,c)=>{const i=setTimeout(()=>{c(new Error("Request timeout"))},n);fetch(t,e).then(r=>{clearTimeout(i),o(r)}).catch(r=>{clearTimeout(i),c(r)})})}async function u(t,e={}){const{method:n="GET",headers:o={},body:c,timeout:i=1e4}=e,r={...f,...o};c&&typeof c=="string"&&(r["Content-Type"]="application/json");const a=g();a&&n!=="GET"&&(r["X-CSRF-Token"]=a);try{const s=await m(t,{method:n,headers:r,body:c},i),l=s.headers.get("Content-Type")||"";if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);return l.includes("application/json")?await s.json():{success:!0,data:await s.text()}}catch(s){return console.error("Request failed:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}function h(t,e){return u(t,{method:"GET",headers:e})}function w(t,e,n){const o=e instanceof FormData?e:JSON.stringify(e);return u(t,{method:"POST",body:o,headers:n})}function p(t,e,n){const o=e instanceof FormData?e:JSON.stringify(e);return u(t,{method:"PUT",body:o,headers:n})}function b(t,e){return u(t,{method:"DELETE",headers:e})}export{h as a,p as b,b as d,g,w as p};
