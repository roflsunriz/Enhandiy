const g=["password","password123","123456","12345678","qwerty","abc123","admin","root","user","guest","test","demo","login","pass","111111","000000","123123","789456","qwerty123","password1","admin123","root123","user123","test123","demo123","login123","iloveyou","welcome","monkey","dragon","sunshine","master","1234567890","abcdefgh","letmein","trustno1","princess","football","baseball","basketball","superman","batman"],f=["パスワード","ぱすわーど","password","あいうえお","かきくけこ","さしすせそ","たちつてと","なにぬねの","はひふへほ","まみむめも","やゆよ","らりるれろ","わをん","あああああ","いいいいい"];function d(t){const l=[];let n=0;if(t.length<6)return l.push("6文字以上にしてください"),{score:0,level:"weak",message:"短すぎます",warnings:l};const r=t.toLowerCase();if(g.includes(r)||f.includes(t))return l.push("よく使われるパスワードです"),{score:0,level:"weak",message:"危険です",warnings:l};t.length>=8&&(n+=25),t.length>=12&&(n+=15),t.length>=16&&(n+=10),/[a-z]/.test(t)&&(n+=10),/[A-Z]/.test(t)&&(n+=10),/[0-9]/.test(t)&&(n+=10),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(t)&&(n+=15),/[ひらがなカタカナ漢字]/.test(t)&&(n+=5),/(.)\1{2,}/.test(t)&&(n-=15,l.push("同じ文字の連続は避けてください")),/123|234|345|456|567|678|789|890|abc|bcd|cde|def/.test(r)&&(n-=10,l.push("連続する文字・数字は避けてください"));let e,s;return n<30?(e="weak",s="弱い",t.length<8&&l.push("8文字以上推奨")):n<60?(e="fair",s="普通"):n<80?(e="good",s="良い"):(e="strong",s="強い"),{score:n,level:e,message:s,warnings:l}}function u(t,l,n){const r=document.getElementById(t),e=document.getElementById(l);if(!r||!e)return;if(n.length===0){e.style.visibility="hidden",r.classList.remove("password-weak","password-fair","password-good","password-strong");return}const s=d(n),i=e.querySelector(`#${l}-level`),o=e.querySelector(`#${l}-text`);if(!(!i||!o)){if(e.style.visibility="visible",i.className=`strength-level ${s.level}`,o.className=`strength-text ${s.level}`,o.textContent=s.message,s.warnings.length>0){let a=e.querySelector(".password-warning");a||(a=document.createElement("div"),a.className="password-warning",e.appendChild(a)),a.textContent=s.warnings[0]}else{const a=e.querySelector(".password-warning");a&&a.remove()}r.classList.remove("password-weak","password-fair","password-good","password-strong"),r.classList.add(`password-${s.level}`)}}function c(t){if(t.length===0)return!1;const l=d(t);return l.level==="weak"&&l.score<20}function m(){const t=document.getElementById("dlkeyInput"),l=document.getElementById("delkeyInput"),n=document.getElementById("replaceKeyInput");t&&t.addEventListener("input",e=>{const s=e.target;u("dlkeyInput","dlkey-strength",s.value)}),l&&l.addEventListener("input",e=>{const s=e.target;u("delkeyInput","delkey-strength",s.value)}),n&&n.addEventListener("input",e=>{const s=e.target;u("replaceKeyInput","replacekey-strength",s.value)});const r=document.getElementById("upload");r&&r.addEventListener("submit",e=>{const s=t?.value||"",i=l?.value||"",o=n?.value||"";if(s&&c(s)){e.preventDefault(),alert("DLキーが弱すぎます。より複雑なキーを設定してください。"),t?.focus();return}if(i&&c(i)){e.preventDefault(),alert("削除キーが弱すぎます。より複雑なキーを設定してください。"),l?.focus();return}if(o&&c(o)){e.preventDefault(),alert("差し替えキーが弱すぎます。より複雑なキーを設定してください。"),n?.focus();return}})}document.addEventListener("DOMContentLoaded",m);
