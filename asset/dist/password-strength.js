const g=["password","password123","123456","12345678","qwerty","abc123","admin","root","user","guest","test","demo","login","pass","111111","000000","123123","789456","qwerty123","password1","admin123","root123","user123","test123","demo123","login123","iloveyou","welcome","monkey","dragon","sunshine","master","1234567890","abcdefgh","letmein","trustno1","princess","football","baseball","basketball","superman","batman"],f=["パスワード","ぱすわーど","password","あいうえお","かきくけこ","さしすせそ","たちつてと","なにぬねの","はひふへほ","まみむめも","やゆよ","らりるれろ","わをん","あああああ","いいいいい"];function c(e){const n=[];let s=0;if(e.length<6)return n.push("6文字以上にしてください"),{score:0,level:"weak",message:"短すぎます",warnings:n};const r=e.toLowerCase();if(g.includes(r)||f.includes(e))return n.push("よく使われるパスワードです"),{score:0,level:"weak",message:"危険です",warnings:n};e.length>=8&&(s+=25),e.length>=12&&(s+=15),e.length>=16&&(s+=10),/[a-z]/.test(e)&&(s+=10),/[A-Z]/.test(e)&&(s+=10),/[0-9]/.test(e)&&(s+=10),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e)&&(s+=15),/[ひらがなカタカナ漢字]/.test(e)&&(s+=5),/(.)\1{2,}/.test(e)&&(s-=15,n.push("同じ文字の連続は避けてください")),/123|234|345|456|567|678|789|890|abc|bcd|cde|def/.test(r)&&(s-=10,n.push("連続する文字・数字は避けてください"));let t,l;return s<30?(t="weak",l="弱い",e.length<8&&n.push("8文字以上推奨")):s<60?(t="fair",l="普通"):s<80?(t="good",l="良い"):(t="strong",l="強い"),{score:s,level:t,message:l,warnings:n}}function d(e,n,s){const r=document.getElementById(e),t=document.getElementById(n);if(!r||!t)return;if(s.length===0){t.style.visibility="hidden",r.classList.remove("password-weak","password-fair","password-good","password-strong");return}const l=c(s),i=t.querySelector(`#${n}-level`),a=t.querySelector(`#${n}-text`);if(!(!i||!a)){if(t.style.visibility="visible",i.className=`strength-level ${l.level}`,a.className=`strength-text ${l.level}`,a.textContent=l.message,l.warnings.length>0){let o=t.querySelector(".password-warning");o||(o=document.createElement("div"),o.className="password-warning",t.appendChild(o)),o.textContent=l.warnings[0]}else{const o=t.querySelector(".password-warning");o&&o.remove()}r.classList.remove("password-weak","password-fair","password-good","password-strong"),r.classList.add(`password-${l.level}`)}}function u(e){if(e.length===0)return!1;const n=c(e);return n.level==="weak"&&n.score<20}function m(){const e=document.getElementById("dlkeyInput"),n=document.getElementById("delkeyInput");e&&e.addEventListener("input",r=>{const t=r.target;d("dlkeyInput","dlkey-strength",t.value)}),n&&n.addEventListener("input",r=>{const t=r.target;d("delkeyInput","delkey-strength",t.value)});const s=document.getElementById("upload");s&&s.addEventListener("submit",r=>{const t=e?.value||"",l=n?.value||"";if(t&&u(t)){r.preventDefault(),alert("DLキーが弱すぎます。より複雑なキーを設定してください。"),e?.focus();return}if(l&&u(l)){r.preventDefault(),alert("削除キーが弱すぎます。より複雑なキーを設定してください。"),n?.focus();return}})}document.addEventListener("DOMContentLoaded",m);
