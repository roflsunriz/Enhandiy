# データベースとマイグレーション

## データベース変更

新しいテーブル:
- `folders`: 階層フォルダ構造管理
- `file_history`: ファイル履歴管理
- `tus_uploads`: 再開可能アップロードセッション管理

拡張されたテーブル:
- `uploaded`: `replace_key`, `folder_id`, `max_downloads`, `expires_at` を追加
- パフォーマンス向上のためのインデックス改善

## マイグレーションと互換性

- 初回アクセス時に自動的に DB スキーマを更新
- 既存ファイルデータとの後方互換性を維持
- スムーズなアップグレードのためのスクリプトを同梱

## v1.x からのアップグレード

1. 必ずバックアップを取得
2. 新バージョンのファイルで更新
3. `backend/config/config.php` に新しい設定オプションを追加
4. アプリケーションへアクセス（自動マイグレーション実行）

初回アクセス後、ログでマイグレーション状況を確認できます。

