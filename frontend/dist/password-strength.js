const d=["password","password123","123456","12345678","qwerty","abc123","admin","root","user","guest","test","demo","login","pass","111111","000000","123123","789456","qwerty123","password1","admin123","root123","user123","test123","demo123","login123","iloveyou","welcome","monkey","dragon","sunshine","master","1234567890","abcdefgh","letmein","trustno1","princess","football","baseball","basketball","superman","batman"],g=["パスワード","ぱすわーど","password","あいうえお","かきくけこ","さしすせそ","たちつてと","なにぬねの","はひふへほ","まみむめも","やゆよ","らりるれろ","わをん","あああああ","いいいいい"];function f(e){const l=[];let t=0;if(e.length<6)return l.push("6文字以上にしてください"),{score:0,level:"weak",message:"短すぎます",warnings:l};const r=e.toLowerCase();if(d.includes(r)||g.includes(e))return l.push("よく使われるパスワードです"),{score:0,level:"weak",message:"危険です",warnings:l};e.length>=8&&(t+=25),e.length>=12&&(t+=15),e.length>=16&&(t+=10),/[a-z]/.test(e)&&(t+=10),/[A-Z]/.test(e)&&(t+=10),/[0-9]/.test(e)&&(t+=10),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e)&&(t+=15),/[ひらがなカタカナ漢字]/.test(e)&&(t+=5),/(.)\1{2,}/.test(e)&&(t-=15,l.push("同じ文字の連続は避けてください")),/123|234|345|456|567|678|789|890|abc|bcd|cde|def/.test(r)&&(t-=10,l.push("連続する文字・数字は避けてください"));let n,s;return t<30?(n="weak",s="弱い",e.length<8&&l.push("8文字以上推奨")):t<60?(n="fair",s="普通"):t<80?(n="good",s="良い"):(n="strong",s="強い"),{score:t,level:n,message:s,warnings:l}}function u(e,l,t){const r=document.getElementById(e),n=document.getElementById(l);if(!r||!n)return;if(t.length===0){n.style.visibility="hidden",r.classList.remove("password-weak","password-fair","password-good","password-strong");return}const s=f(t),i=n.querySelector(`#${l}-level`),o=n.querySelector(`#${l}-text`);if(!(!i||!o)){if(n.style.visibility="visible",i.className=`strength-level ${s.level}`,o.className=`strength-text ${s.level}`,o.textContent=s.message,s.warnings.length>0){let a=n.querySelector(".password-warning");a||(a=document.createElement("div"),a.className="password-warning",n.appendChild(a)),a.textContent=s.warnings[0]}else{const a=n.querySelector(".password-warning");a&&a.remove()}r.classList.remove("password-weak","password-fair","password-good","password-strong"),r.classList.add(`password-${s.level}`)}}function c(e){if(e.length===0)return!1;if(e.length<6)return!0;const l=e.toLowerCase();if(d.includes(l)||g.includes(e))return!0;const t=f(e);return t.level==="weak"&&t.score<20}function m(){const e=document.getElementById("dlkeyInput"),l=document.getElementById("delkeyInput"),t=document.getElementById("replaceKeyInput");e&&e.addEventListener("input",n=>{const s=n.target;u("dlkeyInput","dlkey-strength",s.value)}),l&&l.addEventListener("input",n=>{const s=n.target;u("delkeyInput","delkey-strength",s.value)}),t&&t.addEventListener("input",n=>{const s=n.target;u("replaceKeyInput","replacekey-strength",s.value)});const r=document.getElementById("upload");r&&r.addEventListener("submit",n=>{const s=e?.value||"",i=l?.value||"",o=t?.value||"";if(s&&c(s)){n.preventDefault(),alert("DLキーが弱すぎます。より複雑なキーを設定してください。"),e?.focus();return}if(i&&c(i)){n.preventDefault(),alert("削除キーが弱すぎます。より複雑なキーを設定してください。"),l?.focus();return}if(o&&c(o)){n.preventDefault(),alert("差し替えキーが弱すぎます。より複雑なキーを設定してください。"),t?.focus();return}})}document.addEventListener("DOMContentLoaded",m);export{c as i};
